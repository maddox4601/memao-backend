import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.BVOCwoKb.js";import{A as l}from"./api.BaUma9nm.js";function N(){const[t,a]=r.useState(""),[s,o]=r.useState(0),[i,n]=r.useState(""),[d,c]=r.useState([]);r.useEffect((()=>{const e=localStorage.getItem("walletAddress");e&&(a(e),m(e),h(e))}),[]);const m=async e=>{try{const t=await(await fetch(l.CHECKIN_STATUS(e))).json();void 0!==t.points&&o(t.points)}catch(e){console.error("Failed to fetch points:",e)}},h=async e=>{try{const t=await(await fetch(l.WITHDRAW_HISTORY(e))).json();t.success&&c(t.history)}catch(e){console.error("Failed to fetch withdrawal history:",e)}};return e.jsxs("section",{className:"py-20 bg-white dark:bg-gray-900 max-w-3xl mx-auto px-4",children:[e.jsx("h1",{className:"text-4xl font-bold mb-6 text-center",children:"Withdraw MEMAO Points"}),e.jsxs("div",{className:"mb-6 p-6 bg-gray-50 dark:bg-gray-800 rounded-lg shadow",children:[e.jsx("p",{className:"text-lg font-semibold mb-2",children:"Current Wallet:"}),e.jsx("p",{className:"font-mono break-all text-blue-600 dark:text-blue-400",children:t}),e.jsxs("p",{className:"mt-4 text-lg font-semibold",children:["Available Points: ",s," MEMAO"]}),e.jsxs("div",{className:"mt-6 flex items-center gap-4",children:[e.jsx("input",{type:"text",value:i,onChange:e=>{let t=e.target.value;""!==t?/^\d*$/.test(t)&&(t=t.replace(/^0+/,"")||"0",n(t)):n("")},className:"border rounded px-4 py-2 w-40",placeholder:"Withdraw amount"}),e.jsx("button",{onClick:async()=>{const e=Number(i);if(e<100)alert("Minimum 100 MEMAO points required for withdrawal");else if(e>s)alert("Insufficient points");else try{const a=await(await fetch(l.WITHDRAW,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({walletAddress:t,amount:e})})).json();a.success?(alert("Withdrawal request submitted successfully!"),m(t),h(t)):alert(a.message||"Withdrawal failed")}catch(e){console.error("Withdrawal failed:",e),alert("Withdrawal failed. Please try again.")}},className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded transition",children:"Withdraw"})]})]}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Withdrawal History"}),0===d.length?e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"No withdrawal records found."}):e.jsx("ul",{className:"space-y-4",children:d.map((t=>e.jsxs("li",{className:"p-4 border rounded-lg dark:border-gray-700",children:[e.jsxs("p",{className:"font-semibold",children:["Amount: ",t.amount," MEMAO"]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Requested At: ",new Date(t.requested_at).toLocaleString()]}),e.jsxs("p",{className:"font-semibold mt-2 "+("pending"===t.status?"text-yellow-500":"completed"===t.status?"text-green-500":"text-red-500"),children:["Status: ",t.status]})]},t.id)))})]})}export{N as default};