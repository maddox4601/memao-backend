import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.BVOCwoKb.js";import{A as m}from"./api.BaUma9nm.js";function j(){const[a,r]=l.useState(!0),[t,s]=l.useState({username:"",email:"",password:"",captcha:""}),[d,o]=l.useState(m.CAPTCHA),[n,i]=l.useState(!1),[c,u]=l.useState(""),p=()=>{o(`${m.CAPTCHA}?${Date.now()}`)},x=e=>{s({...t,[e.target.name]:e.target.value}),u("")};return e.jsxs("div",{className:"max-w-md w-full mx-auto p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-3xl font-extrabold text-center mb-8 text-gray-900 dark:text-white",children:a?"登录":"注册"}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),a?(async()=>{if(t.username&&t.password&&t.captcha){i(!0);try{const e=await(await fetch(m.LOGIN,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:t.username,password:t.password,captcha:t.captcha})})).json();e.success?(localStorage.setItem("token",e.token),window.location.href="/memaoadmin"):(u(e.message||"登录失败"),p(),s({...t,captcha:""}))}catch{u("网络错误，请稍后重试"),p()}i(!1)}else u("用户名、密码和验证码不能为空")})():(async()=>{if(t.username&&t.email&&t.password){i(!0);try{const e=await(await fetch(m.REGISTER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t.username,email:t.email,password:t.password})})).json();e.success?(alert("注册成功，请登录"),r(!0),s({username:"",email:"",password:"",captcha:""}),p()):u(e.message||"注册失败")}catch{u("网络错误，请稍后重试")}i(!1)}else u("用户名、邮箱和密码不能为空")})()},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block mb-2 font-medium text-gray-700 dark:text-gray-300",children:"用户名"}),e.jsx("input",{id:"username",name:"username",type:"text",value:t.username,onInput:x,disabled:n,className:"w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"请输入用户名"})]}),!a&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 font-medium text-gray-700 dark:text-gray-300",children:"邮箱"}),e.jsx("input",{id:"email",name:"email",type:"email",value:t.email,onInput:x,disabled:n,className:"w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"请输入邮箱"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block mb-2 font-medium text-gray-700 dark:text-gray-300",children:"密码"}),e.jsx("input",{id:"password",name:"password",type:"password",value:t.password,onInput:x,disabled:n,className:"w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"请输入密码"})]}),a&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"captcha",className:"block mb-2 font-medium text-gray-700 dark:text-gray-300",children:"验证码"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{id:"captcha",name:"captcha",type:"text",value:t.captcha,onInput:x,disabled:n,className:"flex-1 px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"请输入验证码"}),e.jsx("img",{src:d,alt:"验证码",onClick:p,className:"h-12 w-28 cursor-pointer rounded border border-gray-300 dark:border-gray-600",title:"点击刷新验证码"})]})]}),c&&e.jsx("p",{className:"text-red-500 text-center text-sm",children:c}),e.jsx("button",{type:"submit",disabled:n,className:"w-full py-3 rounded-md text-white font-semibold transition duration-300 "+(n?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"),children:n?a?"登录中...":"注册中...":a?"登录":"注册"})]}),e.jsxs("p",{className:"mt-6 text-center text-sm text-gray-600 dark:text-gray-400",children:[a?"没有账号？":"已有账号？"," ",e.jsx("button",{type:"button",onClick:()=>{u(""),r(!a),p()},disabled:n,className:"text-blue-600 hover:underline font-medium",children:a?"去注册":"去登录"})]})]})}export{j as default};